# Task: T5.6.2 - Prometheus ServiceMonitor
# Implements: phase5-spec.md Section 7.1 (Metrics Collection)
# Generated by: kubectl + cicd-monitoring-agent
# Constitution: v5.0 compliant

apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: backend-api
  namespace: monitoring
  labels:
    app: backend
    component: monitoring
spec:
  selector:
    matchLabels:
      app: backend
  namespaceSelector:
    matchNames:
    - default
    - todo-app
  endpoints:
  - port: metrics
    interval: 15s
    path: /metrics
    scheme: http
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: frontend
  namespace: monitoring
  labels:
    app: frontend
    component: monitoring
spec:
  selector:
    matchLabels:
      app: frontend
  namespaceSelector:
    matchNames:
    - default
    - todo-app
  endpoints:
  - port: metrics
    interval: 15s
    path: /metrics
    scheme: http
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: reminder-worker
  namespace: monitoring
  labels:
    app: reminder-worker
    component: monitoring
spec:
  selector:
    matchLabels:
      app: reminder-worker
  namespaceSelector:
    matchNames:
    - default
    - todo-app
  endpoints:
  - port: metrics
    interval: 15s
    path: /metrics
    scheme: http
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: dapr-sidecars
  namespace: monitoring
  labels:
    component: dapr
spec:
  selector:
    matchLabels:
      dapr.io/enabled: "true"
  namespaceSelector:
    any: true
  endpoints:
  - port: dapr-metrics
    interval: 15s
    path: /metrics
    scheme: http
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: kafka
  namespace: monitoring
  labels:
    app: kafka
    component: monitoring
spec:
  selector:
    matchLabels:
      app: kafka
  namespaceSelector:
    matchNames:
    - default
    - kafka
  endpoints:
  - port: metrics
    interval: 30s
    path: /metrics
    scheme: http
